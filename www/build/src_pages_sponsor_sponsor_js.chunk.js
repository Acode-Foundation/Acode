"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkcom_foxdebug_acode"] =
	self["webpackChunkcom_foxdebug_acode"] || []).push([
	["src_pages_sponsor_sponsor_js"],
	{
		/***/ "./src/pages/sponsor/sponsor.js":
			/*!**************************************!*\
  !*** ./src/pages/sponsor/sponsor.js ***!
  \**************************************/
			/***/ function (
				__unused_webpack_module,
				__webpack_exports__,
				__webpack_require__,
			) {
				eval(
					'{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "default": function() { return /* binding */ Sponsor; }\n/* harmony export */ });\n/* harmony import */ var html_tag_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! html-tag-js */ "./node_modules/html-tag-js/dist/tag.js");\n/* harmony import */ var html_tag_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(html_tag_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/typeof */ "./node_modules/@babel/runtime/helpers/esm/typeof.js");\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ "./node_modules/@babel/runtime/helpers/esm/defineProperty.js");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ "./node_modules/@babel/runtime/helpers/esm/slicedToArray.js");\n/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _style_scss__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./style.scss */ "./src/pages/sponsor/style.scss");\n/* harmony import */ var _deadlyjack_ajax__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @deadlyjack/ajax */ "./node_modules/@deadlyjack/ajax/dist/ajax.js");\n/* harmony import */ var _deadlyjack_ajax__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_deadlyjack_ajax__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var components_page__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! components/page */ "./src/components/page.js");\n/* harmony import */ var dialogs_alert__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! dialogs/alert */ "./src/dialogs/alert.js");\n/* harmony import */ var dialogs_box__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! dialogs/box */ "./src/dialogs/box.js");\n/* harmony import */ var dialogs_loader__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! dialogs/loader */ "./src/dialogs/loader.js");\n/* harmony import */ var dialogs_multiPrompt__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! dialogs/multiPrompt */ "./src/dialogs/multiPrompt.js");\n/* harmony import */ var fileSystem__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! fileSystem */ "./src/fileSystem/index.js");\n/* harmony import */ var lib_actionStack__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! lib/actionStack */ "./src/lib/actionStack.js");\n/* harmony import */ var lib_constants__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! lib/constants */ "./src/lib/constants.js");\n/* harmony import */ var utils_helpers__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! utils/helpers */ "./src/utils/helpers.js");\n\n\n\n\n\n\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_2__["default"])(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _createForOfIteratorHelper(r, e) { var t = "undefined" != typeof Symbol && r[Symbol.iterator] || r["@@iterator"]; if (!t) { if (Array.isArray(r) || (t = _unsupportedIterableToArray(r)) || e && r && "number" == typeof r.length) { t && (r = t); var _n = 0, F = function F() {}; return { s: F, n: function n() { return _n >= r.length ? { done: !0 } : { done: !1, value: r[_n++] }; }, e: function e(r) { throw r; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var o, a = !0, u = !1; return { s: function s() { t = t.call(r); }, n: function n() { var r = t.next(); return a = r.done, r; }, e: function e(r) { u = !0, o = r; }, f: function f() { try { a || null == t["return"] || t["return"](); } finally { if (u) throw o; } } }; }\nfunction _unsupportedIterableToArray(r, a) { if (r) { if ("string" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return "Object" === t && r.constructor && (t = r.constructor.name), "Map" === t || "Set" === t ? Array.from(r) : "Arguments" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }\nfunction _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }\n\n\n\n\n\n\n\n\n\n\n\n\n//TODO: fix (-1 means, user is not logged in to any google account)\n\n/**\n * Sponsor page\n * @param {() => void} onclose \n */\nfunction Sponsor(onclose) {\n  var BASE_URL = "https://acode.app/res/";\n  var $page = (0,components_page__WEBPACK_IMPORTED_MODULE_8__["default"])(strings.sponsor);\n  var cancel = false;\n  lib_actionStack__WEBPACK_IMPORTED_MODULE_14__["default"].push({\n    id: "sponsor_page",\n    action: $page.hide\n  });\n  $page.onhide = function () {\n    onclose === null || onclose === void 0 || onclose();\n    cancel = true;\n    lib_actionStack__WEBPACK_IMPORTED_MODULE_14__["default"].remove("sponsor_page");\n  };\n  app.append($page);\n  iap.setPurchaseUpdatedListener(function (purchases) {\n    if (Array.isArray(purchases)) {\n      (0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__["default"])(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_5___default().mark(function _callee() {\n        var promises, _loop, _iterator, _step, purchase, settledPromises, rejectedPromise, msg, blob, url, order, _order$productIds, productId, sponsorDetails, res, _t, _t2;\n        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_5___default().wrap(function (_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              promises = [];\n              _loop = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_5___default().mark(function _loop(purchase) {\n                return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_5___default().wrap(function (_context) {\n                  while (1) switch (_context.prev = _context.next) {\n                    case 0:\n                      promises.push(new Promise(function (resolve, reject) {\n                        iap.consume(purchase.purchaseToken, function (resCode) {\n                          purchase.consumed = resCode === iap.OK ? true : false;\n                          purchase.consumeCode = resCode;\n                          resolve(purchase);\n                        }, function (err) {\n                          reject(err);\n                        });\n                      }));\n                    case 1:\n                    case "end":\n                      return _context.stop();\n                  }\n                }, _loop);\n              });\n              _iterator = _createForOfIteratorHelper(purchases);\n              _context2.prev = 1;\n              _iterator.s();\n            case 2:\n              if ((_step = _iterator.n()).done) {\n                _context2.next = 4;\n                break;\n              }\n              purchase = _step.value;\n              return _context2.delegateYield(_loop(purchase), "t0", 3);\n            case 3:\n              _context2.next = 2;\n              break;\n            case 4:\n              _context2.next = 6;\n              break;\n            case 5:\n              _context2.prev = 5;\n              _t = _context2["catch"](1);\n              _iterator.e(_t);\n            case 6:\n              _context2.prev = 6;\n              _iterator.f();\n              return _context2.finish(6);\n            case 7:\n              _context2.next = 8;\n              return Promise.allSettled(promises);\n            case 8:\n              settledPromises = _context2.sent;\n              rejectedPromise = settledPromises.find(function (promise) {\n                return promise.status === "rejected";\n              });\n              msg = "";\n              if (!rejectedPromise) {\n                _context2.next = 9;\n                break;\n              }\n              msg = "Something went wrong.\\n";\n              msg += "Error: ".concat(rejectedPromise.reason, "\\n");\n              msg += "Code: ".concat(rejectedPromise.value.resCode);\n              _context2.next = 11;\n              break;\n            case 9:\n              _context2.next = 10;\n              return _deadlyjack_ajax__WEBPACK_IMPORTED_MODULE_7___default()({\n                url: BASE_URL + "6.jpeg",\n                responseType: "blob"\n              })["catch"](function (err) {\n                utils_helpers__WEBPACK_IMPORTED_MODULE_16__["default"].error(err);\n              });\n            case 10:\n              blob = _context2.sent;\n              url = URL.createObjectURL(blob);\n              msg = "<img src=\\"".concat(url, "\\" class=\\"donate-image\\" />");\n              msg += "<br><p>Thank you for supporting Acode!</p>";\n            case 11:\n              order = settledPromises[0].value;\n              _order$productIds = (0,_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_3__["default"])(order.productIds, 1), productId = _order$productIds[0];\n              sponsorDetails = JSON.parse(localStorage.getItem("sponsor_".concat(productId)));\n              _context2.prev = 12;\n              _context2.next = 13;\n              return _deadlyjack_ajax__WEBPACK_IMPORTED_MODULE_7___default().post("".concat(lib_constants__WEBPACK_IMPORTED_MODULE_15__["default"].API_BASE, "/sponsor"), {\n                data: _objectSpread(_objectSpread({}, sponsorDetails), {}, {\n                  tier: productId,\n                  packageName: BuildInfo.packageName,\n                  purchaseToken: order.purchaseToken\n                })\n              });\n            case 13:\n              res = _context2.sent;\n              if (res.error) {\n                utils_helpers__WEBPACK_IMPORTED_MODULE_16__["default"].error(res.error);\n              } else {\n                (0,dialogs_box__WEBPACK_IMPORTED_MODULE_10__["default"])(strings.info.toUpperCase(), msg);\n                localStorage.removeItem("sponsor_".concat(productId));\n                $page.hide();\n              }\n              _context2.next = 15;\n              break;\n            case 14:\n              _context2.prev = 14;\n              _t2 = _context2["catch"](12);\n              utils_helpers__WEBPACK_IMPORTED_MODULE_16__["default"].error(_t2);\n            case 15:\n              _context2.prev = 15;\n              dialogs_loader__WEBPACK_IMPORTED_MODULE_11__["default"].removeTitleLoader();\n              return _context2.finish(15);\n            case 16:\n            case "end":\n              return _context2.stop();\n          }\n        }, _callee, null, [[1, 5, 6, 7], [12, 14, 15, 16]]);\n      }))();\n    }\n  }, function (err) {\n    if (err !== iap.USER_CANCELED) {\n      (0,dialogs_alert__WEBPACK_IMPORTED_MODULE_9__["default"])(strings.error.toUpperCase(), err);\n    }\n  });\n  dialogs_loader__WEBPACK_IMPORTED_MODULE_11__["default"].showTitleLoader();\n  render()["catch"](function (error) {\n    lib_actionStack__WEBPACK_IMPORTED_MODULE_14__["default"].pop();\n    utils_helpers__WEBPACK_IMPORTED_MODULE_16__["default"].error(error);\n  })["finally"](function () {\n    dialogs_loader__WEBPACK_IMPORTED_MODULE_11__["default"].removeTitleLoader();\n  });\n  function render() {\n    return _render.apply(this, arguments);\n  }\n  function _render() {\n    _render = (0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__["default"])(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_5___default().mark(function _callee2() {\n      var products;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_5___default().wrap(function (_context3) {\n        while (1) switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.next = 1;\n            return new Promise(function (resolve, reject) {\n              iap.getProducts(lib_constants__WEBPACK_IMPORTED_MODULE_15__["default"].SKU_LIST, function (products) {\n                resolve(products);\n              }, function (err) {\n                reject(err);\n              });\n            });\n          case 1:\n            products = _context3.sent;\n            if (!cancel) {\n              _context3.next = 2;\n              break;\n            }\n            return _context3.abrupt("return");\n          case 2:\n            products = products.sort(function (a, b) {\n              var aPrice = Number.parseFloat(a.price.replace(/[^0-9.]/g, ""));\n              var bPrice = Number.parseFloat(b.price.replace(/[^0-9.]/g, ""));\n              return bPrice - aPrice;\n            });\n            $page.body = html_tag_js__WEBPACK_IMPORTED_MODULE_0___default()("div", "main", "sponsor-page", ["\\n      ", html_tag_js__WEBPACK_IMPORTED_MODULE_0___default()("div", "header", ["\\n        ", html_tag_js__WEBPACK_IMPORTED_MODULE_0___default()("span", "logo"), "\\n        ", html_tag_js__WEBPACK_IMPORTED_MODULE_0___default()("h1", ["Sponsor Acode"]), "\\n        ", html_tag_js__WEBPACK_IMPORTED_MODULE_0___default()("p", "subtitle", ["Support the future of mobile coding"]), "\\n      "]), "\\n      ", html_tag_js__WEBPACK_IMPORTED_MODULE_0___default()("div", \'tiers\', ["\\n        ", products.map(function (product) {\n              return html_tag_js__WEBPACK_IMPORTED_MODULE_0___default()("div", "tier ".concat(product.productId), ["\\n            ", html_tag_js__WEBPACK_IMPORTED_MODULE_0___default()("div", \'tier-header\', ["\\n              ", html_tag_js__WEBPACK_IMPORTED_MODULE_0___default()("div", \'tier-name\', ["\\n                ", html_tag_js__WEBPACK_IMPORTED_MODULE_0___default()("span", "tier-icon ".concat(product.productId)), onlyTitle(product.title), "\\n              "]), "\\n              ", html_tag_js__WEBPACK_IMPORTED_MODULE_0___default()("div", \'tier-price\', [product.price]), "\\n            "]), "\\n            ", html_tag_js__WEBPACK_IMPORTED_MODULE_0___default()("div", \'tier-description\', {\n                innerText: product.description\n              }), "\\n            ", html_tag_js__WEBPACK_IMPORTED_MODULE_0___default()("button", "purchase-btn", [strings.select], {\n                onclick: function onclick() {\n                  return handlePurchase(product.productId, product.title);\n                }\n              }), "\\n          "]);\n            }), "\\n      "]), "\\n    "]);\n          case 3:\n          case "end":\n            return _context3.stop();\n        }\n      }, _callee2);\n    }));\n    return _render.apply(this, arguments);\n  }\n}\nfunction handlePurchase(_x, _x2) {\n  return _handlePurchase.apply(this, arguments);\n}\nfunction _handlePurchase() {\n  _handlePurchase = (0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__["default"])(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_5___default().mark(function _callee4(productId, title) {\n    var image, result;\n    return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_5___default().wrap(function (_context5) {\n      while (1) switch (_context5.prev = _context5.next) {\n        case 0:\n          _context5.next = 1;\n          return (0,dialogs_multiPrompt__WEBPACK_IMPORTED_MODULE_12__["default"])(onlyTitle(title), [{\n            placeholder: "Name",\n            required: true,\n            id: "name"\n          }, {\n            placeholder: "Email",\n            required: false,\n            id: "email"\n          }, {\n            placeholder: "Website",\n            required: false,\n            id: "website",\n            type: "url"\n          }, {\n            placeholder: "Logo/Image (500KB max)",\n            required: false,\n            type: "text",\n            id: "image",\n            onclick: function onclick() {\n              var _this = this;\n              sdcard.openDocumentFile(/*#__PURE__*/function () {\n                var _ref2 = (0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__["default"])(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_5___default().mark(function _callee3(res) {\n                  var arraybuffer, blob, reader;\n                  return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_5___default().wrap(function (_context4) {\n                    while (1) switch (_context4.prev = _context4.next) {\n                      case 0:\n                        if (!(res.length > 500000)) {\n                          _context4.next = 1;\n                          break;\n                        }\n                        _this.setError("File size exceeds 500KB");\n                        return _context4.abrupt("return");\n                      case 1:\n                        _this.setError("");\n                        _this.value = res.filename;\n                        _context4.next = 2;\n                        return (0,fileSystem__WEBPACK_IMPORTED_MODULE_13__["default"])(res.uri).readFile();\n                      case 2:\n                        arraybuffer = _context4.sent;\n                        blob = new Blob([arraybuffer], {\n                          type: res.type\n                        });\n                        reader = new FileReader();\n                        reader.onload = function () {\n                          image = reader.result;\n                          if (result && (0,_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_1__["default"])(result) === \'object\') {\n                            result.image = image;\n                            localStorage.setItem("sponsor_".concat(productId), JSON.stringify(result));\n                          }\n                        };\n                        reader.readAsDataURL(blob);\n                      case 3:\n                      case "end":\n                        return _context4.stop();\n                    }\n                  }, _callee3);\n                }));\n                return function (_x3) {\n                  return _ref2.apply(this, arguments);\n                };\n              }(), "image/*");\n            }\n          }, {\n            placeholder: "Show in sponsors list",\n            required: false,\n            id: "public",\n            type: "checkbox",\n            value: true\n          }]);\n        case 1:\n          result = _context5.sent;\n          if (result) {\n            _context5.next = 2;\n            break;\n          }\n          return _context5.abrupt("return");\n        case 2:\n          if (image) {\n            result.image = image;\n          }\n          localStorage.setItem("sponsor_".concat(productId), JSON.stringify(result));\n          dialogs_loader__WEBPACK_IMPORTED_MODULE_11__["default"].showTitleLoader();\n          iap.purchase(productId, function () {}, function (err) {\n            if (err !== iap.USER_CANCELED) {\n              (0,dialogs_alert__WEBPACK_IMPORTED_MODULE_9__["default"])(strings.error, err);\n            }\n          });\n        case 3:\n        case "end":\n          return _context5.stop();\n      }\n    }, _callee4);\n  }));\n  return _handlePurchase.apply(this, arguments);\n}\nfunction onlyTitle(title) {\n  return title.replace(" (Acode - code editor | FOSS)", "");\n}\n\n//# sourceURL=webpack://com.foxdebug.acode/./src/pages/sponsor/sponsor.js?\n}',
				);

				/***/
			},

		/***/ "./src/pages/sponsor/style.scss":
			/*!**************************************!*\
  !*** ./src/pages/sponsor/style.scss ***!
  \**************************************/
			/***/ function (
				__unused_webpack_module,
				__webpack_exports__,
				__webpack_require__,
			) {
				eval(
					"{__webpack_require__.r(__webpack_exports__);\n// extracted by mini-css-extract-plugin\n\n\n//# sourceURL=webpack://com.foxdebug.acode/./src/pages/sponsor/style.scss?\n}",
				);

				/***/
			},
	},
]);

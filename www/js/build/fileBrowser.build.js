(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{528:function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},529:function(e,t,n){"use strict";var r=n(4);t.a=function(e){var t=r.a.credentials,n=[];return Array.isArray(e)&&e.map((function(e){var r=e.name,i=e.username,o=e.password,a=e.hostname,c=e.port,s=e.id,l=e.security,u=e.mode,d=e.path;return i=t.decrypt(i),o=t.decrypt(o),a=t.decrypt(a),c=t.decrypt(c),n.push({username:i,password:o,hostname:a,port:c,name:r||"".concat(i,"@").concat(a),id:s,security:l,mode:u,path:d}),e})),n}},531:function(e,t,n){},548:function(e,t,n){"use strict";n.r(t);var r=n(58),i=n.n(r),o=n(528),a=n.n(o),c=n(1),s=n.n(c),l=n(57),u=n.n(l),d=n(71),f=n(4),p=n(200),m=n(5),h=n(14),g=n(91);function v(e){var t=Object(d.a)(strings.settings),n=s()("div",{className:"main list"});actionStack.push({id:"settings-theme",action:t.hide}),t.onhide=function(){actionStack.remove("settings-theme")};var r=appSettings.value.fileBrowser,i=[{key:"sort",text:strings["sort by name"],checkbox:r.sortByName},{key:"show",text:strings["show hidden files"],checkbox:r.showHiddenFiles}];g.a.listItems(n,i,(function(){switch(this.key){case"sort":r.sortByName=!r.sortByName,appSettings.update(),this.value=r.sortByName,e&&e();break;case"show":r.showHiddenFiles=!r.showHiddenFiles,appSettings.update(),this.value=r.showHiddenFiles,e&&e()}})),t.appendChild(n),document.body.append(t)}n(531);var b=n(141),y=n(51),w=n(201),O={angular:function(){return n.e(1).then(n.bind(null,542))},angularjs:function(){return n.e(2).then(n.bind(null,543))},html:function(){return n.e(10).then(n.bind(null,544))},react:function(){return n.e(12).then(n.bind(null,545))},vue:function(){return n.e(16).then(n.bind(null,546))}},j=n(529),S=n(16),x=n(21);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}t.default=function(e,t,n){e||(e="file"),!n&&localStorage.lastDir&&(n=localStorage.lastDir);var r=window.actionStack,o=m.a.prompt;return new Promise((function(c,l){var g,k,E=s()("i",{className:"icon more_vert",attr:{action:"toggle-menu"}}),L=s()("i",{className:"icon add disabled",attr:{action:"toggle-add-menu"}}),F=s()("i",{className:"icon search",attr:{action:"search"}}),N=Object(d.a)("File Browser"),A=s.a.parse(u.a.render('<div tabindex="-1" class="main" id="file-browser" type="{{type}}">\n  <div class="navigation" tabindex="-1"></div>\n</div>',{type:e})),B=A.querySelector(".navigation"),P=[],I={top:"8px",right:"8px",toggle:E,transformOrigin:"top right"},q=Object(p.a)('<li action="settings">'.concat(strings.settings,"</li>"),I),T=Object(p.a)(u.a.render('<li action="create" value="file">{{new file}}</li>\n<li action="create" value="folder">{{new folder}}</li>\n<li action="create" value="project">{{new project}}</li>',strings),(I.toggle=L)&&I),_="file:///storage/",H={},R={url:"/",name:"File browser"};if(A.addEventListener("click",X),A.addEventListener("contextmenu",U),N.append(A),N.querySelector("header").append(F,L,E),document.body.append(N),r.push({id:"filebrowser",action:function(){l({error:"user canceled",code:0}),N.hide()}}),q.onclick=function(e){q.hide();var t=e.target.getAttribute("action");t&&"settings"===t&&v(V)},T.onclick=function(e){T.hide();var t=e.target.getAttribute("action"),n=e.target.getAttribute("value");t&&"create"===t&&function(e){var t=R.url,n=R.name;if("file"===e||"folder"===e){var r=strings["enter folder name"],i=strings["new folder"];"file"===e&&(r=strings["enter file name"],i="untitiled.txt"),o(r,i,"filename",{match:h.a.FILE_NAME_REGEX,required:!0}).then((function(r){r&&(r=f.a.removeLineBreaks(r),Object(y.a)(t).then((function(t){return"folder"===e?t.createDirectory(r):"file"===e?t.createFile(r):void 0})).then((function(){Q(t),window.plugins.toast.showLongBottom(strings.success),W(t,n)})).catch((function(e){f.a.error(e,t,"filename: "+r),console.error(e)})))}))}else if("project"===e){var a=[],c=[],s="",l="",u=null,d="",p="";Object.keys(O).map((function(e){a.push([e,e,"icon "+e])})),m.a.select(strings["new project"],a).then((function(e){return p=e,m.a.loaderShow(e,strings.loading+"..."),O[e]()})).then((function(e){return m.a.loaderHide(),s=e.default,m.a.prompt(strings["project name"],p,"text",{required:!0,match:h.a.FILE_NAME_REGEX})})).then((function(e){return d=e,Object(y.a)(t)})).then((function(e){return m.a.loaderShow(d,strings.loading+"..."),e.createDirectory(d)})).then((function(e){u=S.a.join(t,d,"/");var r=Object.keys(s);return new Promise((function(e,i){!function e(i,o){r.length||(Q(t),window.plugins.toast.showLongBottom(strings.success),W(t,n),i());l="",(a=r.pop(),f=a.split("/"),p=f.pop(),new Promise((function(e,t){!function n(){var r=S.a.join(u,l);if(0===f.length)return Object(y.a)(r).then((function(e){var t=s[a].replace(/<%name%>/g,d);return e.createFile(p,t)})).then(e).catch(t);var i=f.splice(0,1)[0],o=S.a.join(r,i);Object(y.a)(r).then((function(e){return c.includes(o)?Promise.resolve():e.createDirectory(i)})).then((function(e){return c.includes(o)||c.push(o),l+=i+"/",n(f)})).catch(t)}()}))).then((function(){e(i,o)})).catch(o);var a,f,p}(e,i)}))})).catch((function(e){f.a.error(e),console.error(e)})).finally((function(){m.a.loaderHide()}))}}(n)},F.onclick=function(){var e=A.get("#list");e&&Object(w.a)(e)},N.onhide=function(){for(var e="";e=P.pop();)r.remove(e);r.remove("filebrowser"),A.removeEventListener("click",X),A.removeEventListener("contextmenu",U)},"folder"===e){var C=s()("button",{textContent:t||strings["select folder"]});g=s()("footer",{className:"button-container",child:C}),N.setAttribute("footer-height",1),N.append(g),C.onclick=function(){N.hide(),M(R)}}function J(){parseInt(device.version)<7?G():b.a.listExternalStorages().then((function(e){k=e,G()}))}function M(e){localStorage.setItem("lastDir",R.url),c(e)}function G(){cordova.plugins.diagnostic.getExternalSdCardDetails((function(t){var n=[];t.length>0&&t.map((function(e){var t=e.path.split("/").splice(-1)[0],r=e.filePath+"/";return"files"===t||n.push({name:k&&k[t]?k[t]:t,url:r,origin:r,isDirectory:!0,parent:!0,type:"folder"}),e}));var r,i=cordova.file.externalRootDirectory;n.push({url:i,name:"Internal storage",isDirectory:!0,parent:!0,type:"folder"});try{r=JSON.parse(localStorage.ftpaccounts),Array.isArray(r)&&(r=Object(j.a)(r)).map((function(e){var t=e.mode,r=e.security,i=e.name,o=S.a.formate(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({protocol:"ftp:"},e,{query:{mode:t,security:r}}));n.push({url:o,name:i,isDirectory:!0,parent:!0,type:"folder"})}))}catch(e){console.log(e)}"file"===e&&n.push({name:"Select document",isDirectory:!0,type:"folder","open-doc":!0}),H["/"]={name:name,list:n},delete localStorage.lastDir,K("/","/"),R.url="/",R.name="File Browser",N.settitle("File Browser"),z(n),"folder"===e&&(L.classList.add("disabled"),g.classList.add("disabled"))}))}function W(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"File Browser",o=t;if("object"===i()(t)&&(o=t.url,n=t.name),"/"===o)return G();if(o in H){u();var a=H[o];z(a.list);var c=s.a.get("#list");c.scrollTop=a.scroll,n=a.name}else{var l=setTimeout((function(){m.a.loaderShow("",strings.loading+"...")}),100);Object(y.a)(o).then((function(e){return e.lsDir()})).then((function(e){u(),e=f.a.sortDir(e,appSettings.value.fileBrowser),H[o]={name:n,list:e},z(e)})).catch((function(e){r.remove(R.url),f.a.error(e,o),console.error(e)})).finally((function(){clearTimeout(l),m.a.loaderHide()}))}function u(){"folder"===e&&(o===_?(L.classList.add("disabled"),g.classList.add("disabled")):(L.classList.remove("disabled"),g.classList.remove("disabled"))),localStorage.lastDir=o,R.url=o,R.name=n;var t=s.a.get("#list");t&&(t.scrollTop=0),K(n,o),N.settitle(n)}}function X(e,n){var i=e.target,o=i.getAttribute("action");if(o){var a=i.getAttribute("url"),c=i.getAttribute("name");switch(i.getAttribute("open-doc")&&(o="open-doc"),o){case"navigation":case"folder":!function(){if("contextmenu"!==n){var e=R.url,t=JSON.parse(JSON.stringify(R));H[e].scroll=s.a.get("#list").scrollTop,P.push(e),r.push({id:e,action:function(){P.pop(),W(t),"folder"===o&&K.pop()}}),W(a,c)}else l()}();break;case"file":"contextmenu"!==n?"function"==typeof t&&t(c)&&(N.hide(),M({url:a})):l();break;case"open-doc":SDcard.openDoc((function(e){e.isContentUri=!0,e.url=e.uri,M(e),N.hide()}),(function(e){f.a.error(e),console.error(e)}))}}function l(){navigator.vibrate(h.a.VIBRATION_TIME),m.a.select("",[["delete",strings.delete,"delete"],["rename",strings.rename,"edit"]]).then((function(e){switch(e){case"delete":m.a.confirm(strings["delete {name}"].replace("{name}",c)).then(u);break;case"rename":m.a.prompt(strings.rename,c,"text",{match:h.a.FILE_NAME_REGEX}).then((function(e){!function(e){Object(y.a)(a).then((function(t){return t.renameTo(e)})).then((function(){Q(a),window.plugins.toast.showShortBottom(strings.success),W(R)})).catch((function(e){f.a.error(e),console.error(e)}))}(e)}))}}))}function u(){Object(y.a)(a).then((function(e){return"file"===o?e.deleteFile():"folder"===o?e.deleteDir():void 0})).then((function(){Q(a),window.plugins.toast.showShortBottom(strings.success),W(R)})).catch((function(e){console.log(e),f.a.error(e)}))}}function U(e){X(e,"contextmenu")}function V(){H={},W(R.url,R.name)}function z(e){var t=s.a.parse(u.a.render('<ul class="list" id="list" empty-msg="{{msg}}">{{#list}}\n  {{#.}}\n  <li tabindex="1" class="tile" url="{{url}}" origin="{{origin}}" {{#isDirectory}} action="folder" type="folder"\n    {{/isDirectory}} {{#canWrite}} can-write="true" {{/canWrite}} uuid="{{uuid}}" {{#isFile}} action="file" type="file"\n    {{/isFile}} name="{{name}}" {{#open-doc}} open-doc="true" {{/open-doc}}>\n    <span class="icon {{type}}"></span>\n    <div class="text">\n      <span>{{name}}</span>\n    </div>\n  </li>\n  {{/.}}\n  {{/list}}</ul>',{msg:strings["empty folder message"],list:e})),n=A.querySelector("#list");n&&n.remove(),A.append(t),t.focus()}function K(e,t){var n=B.querySelector('[url="'.concat(t,'"]')),r=B.querySelector(".active");if(r&&r.classList.remove("active"),n)return n.classList.add("active");n=s()("span",{className:"nav active",attr:{action:"navigation",url:t,text:e,name:e},tabIndex:-1}),B.append(n),B.scrollLeft=B.scrollWidth}function Q(e){H[e]&&delete H[e],H[R.url]&&delete H[R.url];var t=!0,n=!1,r=void 0;try{for(var i,o=addedFolder[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a.url===e?a.remove():new RegExp(e).test(R.url)&&a.reload()}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}n?(r.push({id:n,action:function(){K.pop(),J()}}),W(n,x.a.basename(n))):J(),K.pop=function(){var e=B.lastChild;e&&e.remove()}}))}}}]);
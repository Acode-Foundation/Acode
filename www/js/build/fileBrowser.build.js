(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{529:function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},530:function(e,t,n){"use strict";var r=n(3);t.a=function(e){var t=r.a.credentials,n=[];return Array.isArray(e)&&e.map((function(e){var r=e.name,i=e.username,o=e.password,a=e.hostname,c=e.port,s=e.id,l=e.security,u=e.mode,d=e.path;return i=t.decrypt(i),o=t.decrypt(o),a=t.decrypt(a),c=t.decrypt(c),n.push({username:i,password:o,hostname:a,port:c,name:r||"".concat(i,"@").concat(a),id:s,security:l,mode:u,path:d}),e})),n}},532:function(e,t,n){},549:function(e,t,n){"use strict";n.r(t);var r=n(57),i=n.n(r),o=n(529),a=n.n(o),c=n(1),s=n.n(c),l=n(58),u=n.n(l),d=n(65),f=n(3),p=n(201),m=n(4),h=n(13),g=n(74);function v(e){var t=Object(d.a)(strings.settings),n=s()("div",{className:"main list"});actionStack.push({id:"settings-theme",action:t.hide}),t.onhide=function(){actionStack.remove("settings-theme")};var r=appSettings.value.fileBrowser,i=[{key:"sort",text:strings["sort by name"],checkbox:r.sortByName},{key:"show",text:strings["show hidden files"],checkbox:r.showHiddenFiles}];g.a.listItems(n,i,(function(){switch(this.key){case"sort":r.sortByName=!r.sortByName,appSettings.update(),this.value=r.sortByName,e&&e();break;case"show":r.showHiddenFiles=!r.showHiddenFiles,appSettings.update(),this.value=r.showHiddenFiles,e&&e()}})),t.appendChild(n),document.body.append(t)}n(532);var b=n(142),y=n(39),w=n(202),O={angular:function(){return n.e(1).then(n.bind(null,543))},angularjs:function(){return n.e(2).then(n.bind(null,544))},html:function(){return n.e(10).then(n.bind(null,545))},react:function(){return n.e(12).then(n.bind(null,546))},vue:function(){return n.e(16).then(n.bind(null,547))}},j=n(530),S=n(14);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}t.default=function(e,t){e||(e="file");var n=window.actionStack,r=m.a.prompt;return new Promise((function(o,c){var l,g,k=s()("i",{className:"icon more_vert",attr:{action:"toggle-menu"}}),D=s()("i",{className:"icon add disabled",attr:{action:"toggle-add-menu"}}),E=s()("i",{className:"icon search",attr:{action:"search"}}),L=Object(d.a)("File Browser"),F=s.a.parse(u.a.render('<div tabindex="-1" class="main" id="file-browser" type="{{type}}">\n  <div class="navigation" tabindex="-1"></div>\n</div>',{type:e})),N=F.querySelector(".navigation"),A=[],B={top:"8px",right:"8px",toggle:k,transformOrigin:"top right"},P=Object(p.a)('<li action="settings">'.concat(strings.settings,'</li>\n      <li action="reload">').concat(strings.reload,"</li>"),B),I=Object(p.a)(u.a.render('<li action="create" value="file">{{new file}}</li>\n<li action="create" value="folder">{{new folder}}</li>\n<li action="create" value="project">{{new project}}</li>',strings),(B.toggle=D)&&B),q="file:///storage/",T={},_={url:"/",name:"File browser"};if(F.addEventListener("click",M),F.addEventListener("contextmenu",G),L.append(F),L.querySelector("header").append(E,D,k),document.body.append(L),n.push({id:"filebrowser",action:function(){c({error:"user canceled",code:0}),L.hide()}}),P.onclick=function(e){P.hide();var t=e.target.getAttribute("action");if("settings"===t)v(W);else if("reload"===t){var n=_.url,r=_.name;n in T&&delete T[n],H(n,r)}},I.onclick=function(e){I.hide();var t=e.target.getAttribute("action"),n=e.target.getAttribute("value");t&&"create"===t&&function(e){var t=_.url,n=_.name;if("file"===e||"folder"===e){var i=strings["enter folder name"],o=strings["new folder"];"file"===e&&(i=strings["enter file name"],o="untitiled.txt"),r(i,o,"filename",{match:h.a.FILE_NAME_REGEX,required:!0}).then((function(r){r&&(r=f.a.removeLineBreaks(r),Object(y.a)(t).then((function(t){return"folder"===e?t.createDirectory(r):"file"===e?t.createFile(r):void 0})).then((function(e){console.log(e),V(t),window.plugins.toast.showLongBottom(strings.success),H(t,n)})).catch((function(e){f.a.error(e,t,"filename: "+r),console.error(e)})))}))}else if("project"===e){var a=[],c=[],s="",l="",u=null,d="",p="";Object.keys(O).map((function(e){a.push([e,e,"icon "+e])})),m.a.select(strings["new project"],a).then((function(e){return p=e,m.a.loader.create(e,strings.loading+"..."),O[e]()})).then((function(e){return m.a.loader.destroy(),s=e.default,m.a.prompt(strings["project name"],p,"text",{required:!0,match:h.a.FILE_NAME_REGEX})})).then((function(e){return d=e,Object(y.a)(t)})).then((function(e){return m.a.loader.create(d,strings.loading+"..."),e.createDirectory(d)})).then((function(e){u=S.a.join(t,d,"/");var r=Object.keys(s);return new Promise((function(e,i){!function e(i,o){r.length||(V(t),window.plugins.toast.showLongBottom(strings.success),H(t,n),i());l="",(a=r.pop(),f=a.split("/"),p=f.pop(),new Promise((function(e,t){!function n(){var r=S.a.join(u,l);if(0===f.length)return Object(y.a)(r).then((function(e){var t=s[a].replace(/<%name%>/g,d);return e.createFile(p,t)})).then(e).catch(t);var i=f.splice(0,1)[0],o=S.a.join(r,i);Object(y.a)(r).then((function(e){return c.includes(o)?Promise.resolve():e.createDirectory(i)})).then((function(e){return c.includes(o)||c.push(o),l+=i+"/",n(f)})).catch(t)}()}))).then((function(){e(i,o)})).catch(o);var a,f,p}(e,i)}))})).catch((function(e){f.a.error(e),console.error(e)})).finally((function(){m.a.loader.destroy()}))}}(n)},E.onclick=function(){var e=F.get("#list");e&&Object(w.a)(e)},L.onhide=function(){for(var e="";e=A.pop();)n.remove(e);n.remove("filebrowser"),F.removeEventListener("click",M),F.removeEventListener("contextmenu",G)},"folder"===e){var R=s()("button",{textContent:t||strings["select folder"]});l=s()("footer",{className:"button-container",child:R}),L.setAttribute("footer-height",1),L.append(l),R.onclick=function(){L.hide(),C(_)}}function C(e){localStorage.setItem("lastDir",_.url),o(e)}function J(){new Promise((function(t,n){cordova.plugins.diagnostic.getExternalSdCardDetails((function(n){var r=[];n.length>0&&n.map((function(e){var t=e.path.split("/").splice(-1)[0],n=e.filePath+"/";return"files"===t||r.push({name:g&&g[t]?g[t]:t,url:n,origin:n,isDirectory:!0,parent:!0,type:"folder"}),e}));var i,o=cordova.file.externalRootDirectory;r.push({url:o,name:"Internal storage",isDirectory:!0,parent:!0,type:"folder"});try{i=JSON.parse(localStorage.ftpaccounts),Array.isArray(i)&&(i=Object(j.a)(i)).map((function(e){var t=e.mode,n=e.security,i=e.name,o=S.a.formate(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({protocol:"ftp:"},e,{query:{mode:t,security:n}}));r.push({url:o,name:i,isDirectory:!0,parent:!0,type:"folder"})}))}catch(e){}"file"===e&&r.push({name:"Select document",isDirectory:!0,type:"folder","open-doc":!0}),T["/"]={name:name,list:r},t(r)}),n)})).then((function(t){delete localStorage.lastDir,U("/","/"),_.url="/",_.name="File Browser",L.settitle("File Browser"),X(t),"folder"===e&&l.classList.add("disabled"),D.classList.add("disabled")})).catch((function(e){f.a.error(e),console.error(e)}))}function H(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"File Browser",o=t;if("object"===i()(t)&&(o=t.url,r=t.name),"/"===o)return J();if(o in T){d();var a=T[o];X(a.list);var c=s.a.get("#list");c.scrollTop=a.scroll,r=a.name}else{var u=setTimeout((function(){m.a.loader.create("",strings.loading+"...")}),100);Object(y.a)(o).then((function(e){return e.lsDir()})).then((function(e){d(),e=f.a.sortDir(e,appSettings.value.fileBrowser),T[o]={name:r,list:e},X(e)})).catch((function(e){n.remove(_.url),f.a.error(e,o),console.error(e)})).finally((function(){clearTimeout(u),m.a.loader.destroy()}))}function d(){"folder"===e&&(o===q?(D.classList.add("disabled"),l.classList.add("disabled")):(D.classList.remove("disabled"),l.classList.remove("disabled"))),localStorage.lastDir=o,_.url=o,_.name=r;var t=s.a.get("#list");t&&(t.scrollTop=0),U(r,o),L.settitle(r)}}function M(e,r){var i=e.target,o=i.getAttribute("action");if(o){var a=i.getAttribute("url"),c=i.getAttribute("name");switch(i.getAttribute("open-doc")&&(o="open-doc"),o){case"navigation":case"folder":!function(){if("contextmenu"!==r){var e=_.url,t=JSON.parse(JSON.stringify(_));T[e].scroll=s.a.get("#list").scrollTop,A.push(e),n.push({id:e,action:function(){A.pop(),H(t),"folder"===o&&U.pop()}}),H(a,c)}else l()}();break;case"file":"contextmenu"!==r?"function"==typeof t&&t(c)&&(L.hide(),C({url:a})):l();break;case"open-doc":SDcard.openDoc((function(e){e.isContentUri=!0,e.url=e.uri,C(e),L.hide()}),(function(e){f.a.error(e),console.error(e)}))}}function l(){navigator.vibrate(h.a.VIBRATION_TIME),m.a.select("",[["delete",strings.delete,"delete"],["rename",strings.rename,"edit"]]).then((function(e){switch(e){case"delete":m.a.confirm(strings["delete {name}"].replace("{name}",c)).then(u);break;case"rename":m.a.prompt(strings.rename,c,"text",{match:h.a.FILE_NAME_REGEX}).then((function(e){!function(e){Object(y.a)(a).then((function(t){return t.renameTo(e)})).then((function(){V(a),window.plugins.toast.showShortBottom(strings.success),H(_)})).catch((function(e){f.a.error(e),console.error(e)}))}(e)}))}}))}function u(){Object(y.a)(a).then((function(e){return"file"===o?e.deleteFile():"folder"===o?e.deleteDir():void 0})).then((function(){V(a),window.plugins.toast.showShortBottom(strings.success),H(_)})).catch((function(e){console.log(e),f.a.error(e)}))}}function G(e){M(e,"contextmenu")}function W(){T={},H(_.url,_.name)}function X(e){var t=s.a.parse(u.a.render('<ul class="list" id="list" empty-msg="{{msg}}">{{#list}}\n  {{#.}}\n  <li tabindex="1" class="tile" url="{{url}}" origin="{{origin}}" {{#isDirectory}} action="folder" type="folder"\n    {{/isDirectory}} {{#canWrite}} can-write="true" {{/canWrite}} uuid="{{uuid}}" {{#isFile}} action="file" type="file"\n    {{/isFile}} name="{{name}}" {{#open-doc}} open-doc="true" {{/open-doc}}>\n    <span class="icon {{type}}"></span>\n    <div class="text">\n      <span>{{name}}</span>\n    </div>\n  </li>\n  {{/.}}\n  {{/list}}</ul>',{msg:strings["empty folder message"],list:e})),n=F.querySelector("#list");n&&n.remove(),F.append(t),t.focus()}function U(e,t){var n=N.querySelector('[url="'.concat(t,'"]')),r=N.querySelector(".active");if(r&&r.classList.remove("active"),n)return n.classList.add("active");n=s()("span",{className:"nav active",attr:{action:"navigation",url:t,text:e,name:e},tabIndex:-1}),N.append(n),N.scrollLeft=N.scrollWidth}function V(e){T[e]&&delete T[e],T[_.url]&&delete T[_.url];var t=!0,n=!1,r=void 0;try{for(var i,o=addedFolder[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a.url===e?a.remove():new RegExp(e).test(_.url)&&a.reload()}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}parseInt(device.version)<7?J():b.a.listExternalStorages().then((function(e){g=e,J()})),U.pop=function(){var e=N.lastChild;e&&e.remove()}}))}}}]);